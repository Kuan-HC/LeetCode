# 3595 Once Twice

You are given an integer array nums. In this array:

* Exactly one element appears once.
* Exactly one element appears twice.
* All other elements appear exactly three times.

Return an integer array of length 2, where the first element is the one that appears once, and the second is the one that appears twice.

Your solution must run in O(n) time and O(1) space.
 
[LeetCode](https://leetcode.cn/problems/once-twice/description/)

### Example 1

```
Input: nums = [2,2,3,2,5,5,5,7,7]
Output: [3,7]
Explanation:

The element 3 appears once, and the element 7 appears twice. The remaining elements each appear three times.
```

### Example 2


```
Input: nums = [4,4,6,4,9,9,9,6,8]
Output: [8,6]
Explanation:

The element 8 appears once, and the element 6 appears twice. The remaining elements each appear three times.
```

### Constraints

* 3 <= nums.length <= 10<sup>5</sup>
* -2<sup>31</sup> <= nums[i] <= 2<sup>31</sup> - 1
* nums.length is a multiple of 3.
* Exactly one element appears once, one element appears twice, and all other elements appear three times.

### C++ 

```
class Solution {
public:
    vector<int> onceTwice(vector<int>& nums) {
        /*
            與137題相同，每個bit的總數對3取餘數會有0，1，2三種狀態
            我們用兩個bit ab來表示(也可以想成出現1次的bit，出現兩次的bit)
            00->01->10->00
            先看第出現一次的b bit，其只在在twoBit為0時會改變
            當twoBit為1時，保持為0, 也就是如下
            if(twiceNum == 0){
                if(num){
                    onceNum ^= num;
            } else {
                onceNum = 0;
            }
            可再簡寫為: onceNum = onceNum ^ num & ~twiceNum;
            再接著看a bit，由於先計算了onebit擬
            01->00->10，再掉換ab成ba> 10->00->01，也就是0->01->10
            故twiceNum = twiceNum ^ num & ~onceNum;
            以上是137題的解法，本題這兩個數字可以做為分類用的
            oneNum的bit為只出現一次的數字所一定有的bit

            考慮以下數組 onceNum = 1001 twiceNum = 0100
            1011     onceNum及twiceNum可做為過濾用的數值  
            0111     當num & onceNum && num & twiceNum == 0此num有可能為只出現一次的數組
            0111
            1110
            1110
            1110
            1101
            1101
            1101
        */
        int onceMask = 0;
        int twiceMask = 0;
        for(const int& num : nums){            
            onceMask = onceMask ^ num & ~twiceMask;
            twiceMask = twiceMask ^ num & ~onceMask;
        }

        int onceCntOne = 0, onceCntTwo = 0;
        int twiceCntOne = 0, twiceCntTwo = 0;
        for(const int& num : nums){
            if((num & onceMask) == onceMask && (num & twiceMask) == 0){
                onceCntOne = onceCntOne ^ num & ~onceCntTwo;
                onceCntTwo = onceCntTwo ^ num & ~onceCntOne;
            }
            if((num & twiceMask) == twiceMask && (num & onceMask) == 0){
                twiceCntOne = twiceCntOne ^ num & ~twiceCntTwo;
                twiceCntTwo = twiceCntTwo ^ num & ~twiceCntOne;
            }
        }

        return {onceCntOne, twiceCntTwo};
    }
};
```