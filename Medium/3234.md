# 3234 Count the Number of Substrings With Dominant Ones

You are given a binary string s.

Return the number of substrings with dominant ones.

A string has dominant ones if the number of ones in the string is greater than or equal to the square of the number of zeros in the string.

[LeetCode](https://leetcode.cn/problems/count-the-number-of-substrings-with-dominant-ones/description/)

### Example 1

```
Input: s = "00011"

Output: 5

Explanation:

The substrings with dominant ones are shown in the table below.
```

### Example 2

```
Input: s = "101101"

Output: 16

Explanation:

The substrings with non-dominant ones are shown in the table below.

Since there are 21 substrings total and 5 of them have non-dominant ones, it follows that there are 16 substrings with dominant ones.
```

### Constraints

* 1 <= s.length <= 4 * 10<sup>4</sup>
* s consists only of characters '0' and '1'.


### C++ 

```
class Solution {
public:
    int numberOfSubstrings(string s) {
        /*
            遍歷所有的子字符串，這樣會時間複雜度會是n^2
            1. 如何加速，使用prefix記下1的量
            2. 記下每個位置右第一個0的位置
        */
        const int len = s.length();
        vector<int> prefix(len + 1);
        for(int i = 1; i <= len; ++i)
            prefix[i] = prefix[i - 1] + s[i - 1] - '0';

        vector<int> nextZero(len); // next zero position
        nextZero[len - 1] = len;   // sentinal 
        for(int i = len - 2; i >= 0; --i)
            nextZero[i] = s[i + 1] == '0'? i + 1 : nextZero[i + 1];

        int ret = 0;
        for(int left = 0; left < len; ++left){
            int right = left;
            while(right < len) {
                int&& oneCnt = prefix[right + 1] - prefix[left];
                int&& zeroCnt = right - left + 1 - oneCnt;
                if(oneCnt >= zeroCnt * zeroCnt){ // 可以一直延伸到下一個0的位置的前一個,nextZto[right] - 1 - right + 1 
                    ret += nextZero[right] - right;   
                    right = nextZero[right];
                } else {
                    right += zeroCnt * zeroCnt - oneCnt; //至少要往右移這個數量，補足不夠的1的數量
                }
            }
        }

        return ret;
    }
};
```